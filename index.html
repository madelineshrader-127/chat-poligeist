<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The PoliGeist â€“ Politics, Culture, and the Supernatural</title>
    <style>
        /* Reset and base styles */
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family: Georgia, 'Times New Roman', serif; line-height:1.8; color:#333; background:#f9f9f9; }
        header { background:#2c3e50; color:white; padding:2.5rem 0; text-align:center; border-bottom:4px solid #e74c3c; }
        h1 { font-size:3rem; font-weight:700; letter-spacing:2px; margin-bottom:0.5rem; }
        .subtitle { font-size:1.1rem; font-style:italic; opacity:0.9; }
        nav { background:#34495e; position:sticky; top:0; z-index:100; box-shadow:0 2px 5px rgba(0,0,0,0.2); }
        .nav-container { max-width:1000px; margin:0 auto; display:flex; justify-content:center; gap:0; }
        .nav-tab { flex:1; padding:1rem 2rem; background:transparent; border:none; cursor:pointer; font-size:1rem; font-weight:600; color:#ecf0f1; transition:all 0.3s; border-bottom:3px solid transparent; font-family:Georgia, serif; }
        .nav-tab:hover { background:#2c3e50; color:white; }
        .nav-tab.active { background:#2c3e50; border-bottom-color:#e74c3c; }
        .container { max-width:900px; margin:0 auto; padding:2rem 20px; }
        .tab-content { display:none; }
        .tab-content.active { display:block; }
        .admin-toggle { text-align:center; margin:2rem 0; }
        .toggle-btn { background:#95a5a6; color:white; border:none; padding:0.75rem 1.5rem; font-size:0.95rem; border-radius:4px; cursor:pointer; transition:background 0.3s; font-family:Georgia, serif; }
        .toggle-btn:hover { background:#7f8c8d; }
        .admin-panel { background:white; margin:2rem 0; padding:2rem; border-radius:4px; box-shadow:0 2px 8px rgba(0,0,0,0.1); border-left:4px solid #e74c3c; }
        .admin-panel h2 { font-size:1.8rem; margin-bottom:1.5rem; color:#2c3e50; }
        .form-group { margin-bottom:1.5rem; }
        label { display:block; font-weight:600; margin-bottom:0.5rem; color:#2c3e50; font-size:1rem; }
        input, textarea, select { width:100%; padding:0.75rem; border:1px solid #bdc3c7; border-radius:4px; font-size:1rem; font-family:Georgia, serif; transition:border-color 0.3s; }
        select { background:white; cursor:pointer; }
        input:focus, textarea:focus, select:focus { outline:none; border-color:#e74c3c; }
        textarea { min-height:200px; resize:vertical; }
        button[type="submit"], .export-btn { background:#e74c3c; color:white; border:none; padding:0.75rem 2rem; font-size:1rem; border-radius:4px; cursor:pointer; transition:background 0.3s; font-family:Georgia, serif; font-weight:600; }
        button[type="submit"]:hover { background:#c0392b; }
        .export-btn { background:#27ae60; margin-left:1rem; }
        .export-btn:hover { background:#229954; }
        .post { background:white; padding:2.5rem; margin-bottom:2rem; border-radius:4px; box-shadow:0 2px 8px rgba(0,0,0,0.1); border-left:4px solid #3498db; }
        .post h2 { font-size:2rem; color:#2c3e50; margin-bottom:0.75rem; line-height:1.3; }
        .post-meta { color:#7f8c8d; font-size:0.95rem; margin-bottom:1.5rem; font-style:italic; }
        .post-content { color:#34495e; font-size:1.1rem; line-height:1.8; white-space:pre-wrap; }
        .delete-btn { background:#95a5a6; color:white; border:none; padding:0.5rem 1rem; font-size:0.9rem; border-radius:4px; cursor:pointer; margin-top:1rem; transition:background 0.3s; font-family:Georgia, serif; }
        .delete-btn:hover { background:#7f8c8d; }
        .empty-state { text-align:center; padding:4rem 2rem; color:#95a5a6; background:white; border-radius:4px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
        .empty-state h3 { font-size:1.8rem; margin-bottom:1rem; color:#7f8c8d; }
        .empty-state p { font-size:1.1rem; }
        .featured-post { background:white; padding:3rem; margin-bottom:2rem; border-radius:4px; box-shadow:0 4px 12px rgba(0,0,0,0.15); border-left:6px solid #e74c3c; }
        .featured-label { display:inline-block; background:#e74c3c; color:white; padding:0.4rem 1rem; font-size:0.85rem; font-weight:600; text-transform:uppercase; letter-spacing:1px; margin-bottom:1rem; border-radius:3px; }
        .featured-post h2 { font-size:2.5rem; color:#2c3e50; margin-bottom:0.75rem; line-height:1.2; }
        .featured-post .post-meta { color:#7f8c8d; font-size:1rem; margin-bottom:1.5rem; font-style:italic; }
        .featured-post .post-content { color:#34495e; font-size:1.15rem; line-height:1.9; margin-bottom:1.5rem; }
        .read-more { display:inline-block; color:#e74c3c; font-weight:600; text-decoration:none; font-size:1.1rem; transition:color 0.3s; }
        .read-more:hover { color:#c0392b; }
        .category-badge { display:inline-block; background:#3498db; color:white; padding:0.3rem 0.8rem; font-size:0.85rem; border-radius:3px; margin-left:0.5rem; text-transform:capitalize; }
        /* Subscribe box */
        #subscribe-box { text-align:center; margin:3rem 0; }
        #subscribe-box input[type=email] { max-width:300px; margin-right:0.5rem; }
        .thank-you { color:#27ae60; font-weight:600; margin-top:1rem; display:none; }
        /* Comments */
        .comments-section { margin-top:1.5rem; border-top:1px solid #ccc; padding-top:1rem; }
        .comments-section form input, .comments-section form textarea { margin-bottom:0.5rem; }
        .comment { background:#f2f2f2; padding:0.5rem 0.75rem; border-radius:4px; margin-bottom:0.5rem; }
    </style>
</head>
<body>
<header>
    <h1>The PoliGeist</h1>
    <p class="subtitle">Politics, Culture, and the Supernatural</p>
    <div id="jst-clock" style="margin-top:0.5rem; font-size:0.95rem; opacity:0.85;"></div>
</header>

<nav>
    <div class="nav-container">
        <button class="nav-tab active" onclick="switchTab('home')">Home</button>
        <button class="nav-tab" onclick="switchTab('about')">About</button>
        <button class="nav-tab" onclick="switchTab('politics')">Politics</button>
        <button class="nav-tab" onclick="switchTab('japanese')">Japanese Supernatural Culture</button>
    </div>
</nav>

<div class="container">
    <div class="admin-toggle">
        <button class="toggle-btn" onclick="toggleAdmin()">Toggle Admin Panel</button>
    </div>

    <div class="admin-panel" id="adminPanel" style="display:none;">
        <h2>Add New Post</h2>
        <form id="postForm">
            <div class="form-group">
                <label for="category">Category</label>
                <select id="category" required>
                    <option value="about">About</option>
                    <option value="politics">Politics</option>
                    <option value="japanese">Japanese Supernatural Culture</option>
                </select>
            </div>
            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" id="title" required>
            </div>
            <div class="form-group">
                <label for="content">Content</label>
                <textarea id="content" required></textarea>
            </div>
            <button type="submit">Publish Post</button>
            <button type="button" class="export-btn" onclick="exportPosts()">Export Data</button>
        </form>
    </div>

    <div id="homeTab" class="tab-content active">
        <div id="featuredPost">
            <div class="empty-state">
                <h3>Welcome to The PoliGeist</h3>
                <p>No articles published yet. Toggle the admin panel to create your first post!</p>
            </div>
        </div>
    </div>

    <div id="aboutTab" class="tab-content">
        <div id="postsAbout">
            <div class="empty-state">
                <h3>No posts yet</h3>
                <p>Toggle the admin panel above to create your first post!</p>
            </div>
        </div>
    </div>

    <div id="politicsTab" class="tab-content">
        <div id="postsPolitics">
            <div class="empty-state">
                <h3>No posts yet</h3>
                <p>Toggle the admin panel above to create your first post!</p>
            </div>
        </div>
    </div>

    <div id="japaneseTab" class="tab-content">
        <div id="postsJapanese">
            <div class="empty-state">
                <h3>No posts yet</h3>
                <p>Toggle the admin panel above to create your first post!</p>
            </div>
        </div>
    </div>

    <!-- Subscribe box -->
    <div id="subscribe-box">
        <input type="email" id="subscriber-email" placeholder="Enter your email" required>
        <button onclick="subscribe()">Subscribe</button>
        <div class="thank-you" id="thank-you-msg">Thank you for subscribing!</div>
    </div>
</div>

<script>
let posts = JSON.parse(localStorage.getItem('poligeistPosts')) || [];
let currentTab = 'home';

/* JST Clock */
function updateClock() {
    const now = new Date(new Date().toLocaleString("en-US", {timeZone:"Asia/Tokyo"}));
    const options = { weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit' };
    document.getElementById('jst-clock').textContent = now.toLocaleDateString('en-US', options);
}
setInterval(updateClock, 1000);
updateClock();

/* Tabs */
function switchTab(tab){
    currentTab=tab;
    document.querySelectorAll('.nav-tab').forEach(btn=>btn.classList.remove('active'));
    event.target.classList.add('active');
    document.querySelectorAll('.tab-content').forEach(content=>content.classList.remove('active'));
    document.getElementById(tab+'Tab').classList.add('active');
}

/* Save & Render Posts */
function savePosts(){
    localStorage.setItem('poligeistPosts', JSON.stringify(posts));
    renderPosts();
}
function renderPosts(){
    const categories={'about':'About','politics':'Politics','japanese':'Japanese'};
    const featuredContainer=document.getElementById('featuredPost');
    if(posts.length===0){featuredContainer.innerHTML=`<div class="empty-state"><h3>Welcome to The PoliGeist</h3><p>No articles published yet. Toggle the admin panel to create your first post!</p></div>`;}
    else{
        const latest=posts[0];
        const categoryNames={'about':'About','politics':'Politics','japanese':'Japanese Supernatural Culture'};
        const preview=latest.content.substring(0,400)+(latest.content.length>400?'...':'');
        featuredContainer.innerHTML=`<article class="featured-post"><span class="featured-label">Latest Article</span><h2>${escapeHtml(latest.title)}<span class="category-badge">${categoryNames[latest.category]}</span></h2><div class="post-meta">${latest.date}</div><div class="post-content">${escapeHtml(preview)}</div><a href="#" class="read-more" onclick="switchToCategory('${latest.category}'); return false;">Read full article â†’</a></article>`;
    }
    Object.keys(categories).forEach(category=>{
        const container=document.getElementById('posts'+categories[category]);
        const catPosts=posts.filter(p=>p.category===category);
        if(catPosts.length===0){container.innerHTML=`<div class="empty-state"><h3>No posts yet</h3><p>Toggle the admin panel above to create your first post!</p></div>`;}
        else{
            container.innerHTML=catPosts.map(post=>{
                const idx=posts.indexOf(post);
                return `<article class="post"><h2>${escapeHtml(post.title)}</h2><div class="post-meta">${post.date}</div><div class="post-content">${escapeHtml(post.content)}</div><div class="comments-section"><h4>Comments</h4><div class="comments-list" id="comments-post-${idx}"></div><form onsubmit="addComment(event,${idx})"><input type="text" id="commentName-${idx}" placeholder="Your name" required><textarea id="commentText-${idx}" placeholder="Your comment" required></textarea><button type="submit">Add Comment</button></form></div><button class="delete-btn" onclick="deletePost(${idx})">Delete</button></article>`;
            }).join('');
            catPosts.forEach(post=>renderComments(posts.indexOf(post)));
        }
    });
}

/* Post Form */
document.getElementById('postForm').addEventListener('submit',function(e){
    e.preventDefault();
    const category=document.getElementById('category').value;
    const title=document.getElementById('title').value;
    const content=document.getElementById('content').value;
    const post={category,title,content,date:new Date().toLocaleDateString('en-US', {year:'numeric',month:'long',day:'numeric'}),timestamp:Date.now(),comments:[]};
    posts.unshift(post);
    savePosts();
    document.getElementById('category').value='about';
    document.getElementById('title').value='';
    document.getElementById('content').value='';
    alert('Post published successfully!');
});

/* Delete Post */
function deletePost(index){if(confirm('Are you sure you want to delete this post?')){posts.splice(index,1);savePosts();}}

/* Admin Panel */
function toggleAdmin(){const panel=document.getElementById('adminPanel');panel.style.display=panel.style.display==='none'?'block':'none';}

/* Export Posts */
function exportPosts(){const dataStr=JSON.stringify(posts,null,2);const blob=new Blob([dataStr],{type:'application/json'});const url=URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download='poligeist-blog-posts.json';link.click();URL.revokeObjectURL(url);}

/* Escape HTML */
function escapeHtml(text){const div=document.createElement('div');div.textContent=text;return div.innerHTML;}

/* Switch to category tab */
function switchToCategory(category){
    const tabMap={'about':'about','politics':'politics','japanese':'japanese'};
    const tab=tabMap[category];
    document.querySelectorAll('.nav-tab').forEach(btn=>btn.classList.remove('active'));
    document.querySelectorAll('.nav-tab').forEach(btn=>{if(btn.textContent.toLowerCase().includes(category)||(category==='japanese'&&btn.textContent.includes('Japanese'))){btn.classList.add('active');}});
    document.querySelectorAll('.tab-content').forEach(content=>content.classList.remove('active'));
    document.getElementById(tab+'Tab').classList.add('active');
    window.scrollTo({top:0,behavior:'smooth'});
}

/* Comments */
function addComment(e,postIndex){
    e.preventDefault();
    const nameInput=document.getElementById(`commentName-${postIndex}`);
    const textInput=document.getElementById(`commentText-${postIndex}`);
    const name=nameInput.value.trim();
    const text=textInput.value.trim();
    if(!name||!text) return;
    if(!posts[postIndex].comments) posts[postIndex].comments=[];
    posts[postIndex].comments.push({name,text,date:new Date().toLocaleString('en-US',{timeZone:'Asia/Tokyo'})});
    savePosts();
    nameInput.value=''; textInput.value='';
    alert('Comment added!');
}
function renderComments(postIndex){
